<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <meta name="theme-color" content="#0d0d10" />
    <title>3D Tarot Viewer</title>
    <meta name="description" content="Interactive 3D tarot model viewer (pan, zoom, rotate) – PWA optimized for mobile." />
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192x192.png" />
    <link rel="apple-touch-icon" href="./icons/icon-192x192.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="3D Tarot" />
    <link rel="preload" href="./model.glb" as="fetch" type="model/gltf-binary" crossorigin />
    <style>
      :root {
        color-scheme: dark light;
        --bg: #0d0d10;
        --accent: #b38dff;
        --accent-rgb: 179 141 255;
        --radius: 14px;
        --ease: cubic-bezier(.4,.8,.2,1);
      }
      * { box-sizing: border-box; }
      html,body { height: 100%; margin: 0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; background: var(--bg); color: #f5f5f7; }
      body { display: flex; flex-direction: column; overscroll-behavior: none; -webkit-font-smoothing: antialiased; }
      header { padding: .75rem .9rem .25rem; display:flex; align-items:center; gap:.75rem; }
      h1 { font-size: 1rem; font-weight:600; margin:.1rem 0; letter-spacing:.5px; }
      #viewer-wrapper { position: relative; flex: 1 1 auto; min-height: 0; }
      model-viewer { width: 100%; height: 100%; --poster-color: var(--bg); background: radial-gradient(circle at 50% 55%, #1d1d24, #0d0d10 70%); }
      #loading { position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:1rem; font-size:.9rem; background:linear-gradient(145deg,#16161d,#0d0d10); transition:opacity .4s var(--ease), visibility .4s; }
      #loading.hidden { opacity:0; visibility:hidden; }
      progress { width: 200px; max-width: 70vw; height: 8px; appearance:none; border:none; background:#282833; border-radius:4px; overflow:hidden; }
      progress::-webkit-progress-bar { background:#282833; }
      progress::-webkit-progress-value { background:linear-gradient(90deg,rgb(var(--accent-rgb)) 0%, #6d5dff 100%); }
      progress::-moz-progress-bar { background:linear-gradient(90deg,rgb(var(--accent-rgb)) 0%, #6d5dff 100%); }
      #toolbar { position:absolute; top:.65rem; right:.65rem; display:flex; flex-direction:column; gap:.5rem; z-index:10; }
      .btn { backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); background:rgba(40,40,50,.55); color:#fff; border:1px solid rgba(255,255,255,.1); font:600 12px system-ui; padding:.55rem .75rem; border-radius: var(--radius); cursor:pointer; min-width:42px; display:inline-flex; align-items:center; justify-content:center; gap:.35rem; transition:background .3s,var(--ease), border-color .3s; touch-action:manipulation; }
      .btn:active { transform:translateY(1px); }
      .btn:hover { background:rgba(65,65,85,.65); }
      #fps { position:absolute; left:.65rem; bottom:.55rem; font:500 11px/1.1 system-ui; background:rgba(0,0,0,.45); padding:.45rem .55rem; border-radius:8px; backdrop-filter:blur(6px); pointer-events:none; opacity:.6; }
      footer { text-align:center; font-size:11px; padding:.35rem 0 .6rem; opacity:.55; }
      @media (orientation: landscape) and (max-height: 520px){ header { display:none; } footer { display:none; } }
      @media (min-width:900px){ h1 { font-size:1.05rem; } }
    </style>
    <script type="module" defer src="./scripts/app.js"></script>
    <script defer src="./scripts/register-sw.js"></script>
    <script type="module" crossorigin src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  </head>
  <body>
    <header>
      <h1>3D Tarot Viewer</h1>
    </header>
    <div id="viewer-wrapper">
      <div id="toolbar">
        <button id="reset" class="btn" title="Reset view" aria-label="Reset view">Reset</button>
        <button id="fullscreen" class="btn" title="Fullscreen" aria-label="Fullscreen">Full</button>
      </div>
      <div id="loading" role="status" aria-live="polite">
        <div>Loading model… <span id="progress-label">0%</span></div>
        <progress id="progress" max="1" value="0"></progress>
        <div style="font-size:11px;opacity:.55">Optimized for mobile touch: pinch zoom • drag orbit • two-finger pan</div>
      </div>
      <model-viewer id="viewer"
        src="./model.glb"
        camera-controls
        touch-action="pan-y"
        interaction-prompt="none"
        disable-zoom="false"
        camera-orbit="0deg 65deg 100%"
        min-camera-orbit="auto 10deg auto"
        max-camera-orbit="auto 175deg auto"
        field-of-view="35deg"
        interpolation-decay="120"
        exposure="0.9"
        environment-intensity="1.1"
        loading="eager"
        shadow-intensity="0.85"
        ar-modes="webxr scene-viewer quick-look"
        autoplay
        tone-mapping="aces"
        poster=""
        style="--progress-bar-color:rgba(var(--accent-rgb),1)">
      </model-viewer>
      <div id="fps" hidden>FPS</div>
    </div>
    <footer>Offline capable • Install via browser menu</footer>
  </body>
</html>
